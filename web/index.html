<!doctype html>
<meta charset="utf-8" />
<body>
  <script src="./node_modules/axios/dist/axios.min.js"></script>
  <script src="./scripts/d3.min.js"></script>
  <script src="./scripts/graphviz.umd.js"></script>
  <script src="./scripts/d3-graphviz.min.js"></script>
  <div id="graph" style="text-align: center"></div>
  <script>
    const getData = (endpoint) => {
      axios
        .get(endpoint)
        .then((response) => {
          var dotData = response.data["Data"];
 
          var dotIndex = 0;
          var graphviz = d3
          .select("#graph")
          .graphviz()
          .transition(function () {
            return d3.transition().ease(d3.easeLinear).delay(100).duration(150);
          })
          .on("initEnd", render);

          function attributer(datum, index, nodes) {
            var selection = d3.select(this);
            if (datum.tag == "svg") {
              var width = "2664";
              var height = "1696";
              var x = "20";
              var y = "20";
              selection
                .attr("width", width + "pt")
                .attr("height", height + "pt")
                .attr("viewBox", -x + " " + -y + " " + width + " " + height);
              datum.attributes.width = width + "pt";
              datum.attributes.height = height + "pt";
              datum.attributes.viewBox = -x + " " + -y + " " + width + " " + height;
            }
          }

          function render() {
            if (dotIndex >= dotData.length - 1) {
              return;
            }
            var dotLines = dotData[0] + ' node [color=purple]; ';
            for (let index = 0; index <= dotIndex; index++) {
              dotLines = dotLines + '{' + dotData[((index) % (dotData.length - 1)) + 1];
            }
            dotLines += '}'
            graphviz
              .tweenShapes(false)
              .dot(dotLines)
              .attributer(attributer)
              .render()
              .on("end", function () {
                if (dotIndex != 0) {
                  render();
                }
              });
            dotIndex += 1;
          }
            
        })
        .catch((error) => {
          console.error(error);
        });
    };

    // Select One of the Following:
    //
    //  for bfs :
      //  getData("http://127.0.0.1:8000/eightpuzzle/bfs"); 
    //  for dfs :
      //  getData("http://127.0.0.1:8000/eightpuzzle/dfs");
    //  for idfs :
      //  getData(`http://127.0.0.1:8000/eightpuzzle/idfs/${5}`);
    //  for manhatten heuristics :
      //  getData("http://127.0.0.1:8000/eightpuzzle/heuristics/manhatten");
    //  for misplaced heuristics :
      //  getData("http://127.0.0.1:8000/eightpuzzle/heuristics/misplaced");
  </script>
</body>